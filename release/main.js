/*! WeatherApp - v0.1.0 - 2014-07-20 */ 
var app=angular.module("weatherapp",["ngRoute"]);app.config(["$routeProvider",function(a){"use strict";a.when("/",{controller:"WeatherController",templateUrl:"weatherapp-index.html"}).when("/:city",{controller:"WeatherController",templateUrl:"weatherapp-index.html"}).otherwise({redirectTo:"/"})}]),app.filter("climacon",function(){"use strict";var a={"01d":"sun","02d":"cloudSun","03d":"cloud","04d":"cloud","09d":"cloudDrizzleSun","10d":"cloudRainSun","11d":"cloudLightning","13d":"cloudSnow","50d":"cloudFog","01n":"moon","02n":"cloudMoon","03n":"cloud","04n":"cloud","09n":"cloudDrizzleMoon","10n":"cloudRainMoon","11n":"cloudLightning","13n":"cloudSnow","50n":"cloudFog"};return function(b){return a[b]}}),angular.module("weatherapp").factory("weatherService",["$http","$q",function(a,b){"use strict";var c="http://api.openweathermap.org/data/2.5/",d=function(c){var d=c.map(function(c){var d=b.defer();return a.get(c).success(function(a){200==a.cod?d.resolve(a):d.reject()}).error(function(){d.reject()}),d.promise});return b.all(d)};return{getByCityName:function(a,b){var e=c+"weather?q="+a+"&units="+b,f=c+"forecast/daily/?q="+a+"&units="+b+"&count=7";return d([e,f])},getByGeoCoords:function(a,b){var e=c+"weather?lat="+a.latitude+"&lon="+a.longitude+"&units="+b,f=c+"forecast/daily?lat="+a.latitude+"&lon="+a.longitude+"&units="+b+"&count=7";return d([e,f])}}}]),angular.module("weatherapp").controller("WeatherController",["$scope","$location","weatherService",function(a,b,c){"use strict";a.units="metric",a.city=b.path().replace(/^\/|\/$/g,""),a.data={},a.resetData=function(){a.data.weather=a.data.forecasts=a.data.error=void 0},a.fetchData=function(){a.city&&(b.path("/"+a.city),a.resetData(),c.getByCityName(a.city,a.units).then(function(b){var c=b[0],d=b[1];a.data.today=c,a.data.period=c.dt>c.sys.sunset||c.dt<c.sys.sunrise?"night":"day",d.list.shift(),a.data.forecasts=d.list}))},a.toC=function(){a.units="metric",a.fetchData()},a.toF=function(){a.units="imperial",a.fetchData()},!a.city&&"geolocation"in navigator?navigator.geolocation.getCurrentPosition(function(b){a.coords=b.coords,c.getByGeoCoords(a.coords,a.units).then(function(b){var c=b[0],d=b[1];a.data.today=c,a.data.period=c.dt>c.sys.sunset||c.dt<c.sys.sunrise?"night":"day",d.list.shift(),a.data.forecasts=d.list})}):a.fetchData()}]);